#include "messaging/VulnerabilityJsonSerializer.hh"

#include "bridge/Partnership.hh"
#include "bridge/Vulnerability.hh"
#include "messaging/JsonSerializerUtility.hh"

using nlohmann::json;

namespace Bridge {
namespace Messaging {

nlohmann::json JsonConverter<Vulnerability>::convertToJson(
    const Vulnerability& vulnerability)
{
    return {
        {
            PARTNERSHIP_TO_STRING_MAP.left.at(Partnership::NORTH_SOUTH),
            vulnerability.northSouthVulnerable
        },
        {
            PARTNERSHIP_TO_STRING_MAP.left.at(Partnership::EAST_WEST),
            vulnerability.eastWestVulnerable
        }
    };
}

Vulnerability JsonConverter<Vulnerability>::convertFromJson(
    const nlohmann::json& j)
{
    return {
        checkedGet<bool>(
            j, PARTNERSHIP_TO_STRING_MAP.left.at(Partnership::NORTH_SOUTH)),
        checkedGet<bool>(
            j, PARTNERSHIP_TO_STRING_MAP.left.at(Partnership::EAST_WEST))};
}

}
}
